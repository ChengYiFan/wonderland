## JS引擎

浏览器或者Node环境拿到一段JS代码时，首先把代码传递给JS引擎，并且要求它去执行。
当宿主环境遇到一些事件时，会继续把一段代码传递给JS引擎去执行，此外还可能提供API给JS引擎，比如setTimeout这样的API，会在JS的特定的时机执行。

触发JS引擎执行代码的条件有页面加载、用户点击等其他动作。

## 宏任务 和 微任务
由宿主发起的任务称为宏任务，JS引擎发起的任务为微观任务。

具体来说：
这样的话，用户不得不等待一个耗时的操作完成后才能进行后面的操作。这显然是不能容忍的，实际开发中我们可以使用异步代码来解决。

当异步方法比如这里的setTimeout（）或者ajax请求，DOM事件执行的时候，会交由浏览器内核的其他模块去管理。


### 事件机制
javascript引擎是单线程的。在某一个特定的时间内只执行一个任务，并会阻塞其他任务的执行，也就是说这些任务是串行的。这些任务被排队在一个单独的地方，被称为执行战。
js引擎单线程执行，它是基于事件驱动的语言，他的执行顺序是遵循一个叫做事件队列的机制。
浏览器中有各种各样的线程，比如事件触发器，网络请求，定时器等等，线程的联系都是基于事件的。


### 事件循环模型

JS的事件模型是异步的，不使用线程。程序中代码的运行由于其他动作，比如用户点击或页面加载才会触发。

当异步的方法满足触发条件后，该模块就会将方法推入到一个任务队列中，当主线程代码执行完毕处于空闲状态的时候，就回去检查任务队列，将任务队列中的第一个任务入栈执行，完毕后继续检查任务队列，如此循环，前提条件是主线程处于空闲状态，这就是事件循环模型。


JavaScript 是单线程语言，决定于它的设计最初是用来处理浏览器网页的交互。浏览器负责解释和执行 JavaScript 的线程只有一个（所有说是单线程），即JS引擎线程，但是浏览器同样提供其他线程，如：事件触发线程、定时器触发线程等。
异步一般是指：
网络请求
计时器
DOM事件监听
事件循环机制：
JS引擎线程会维护一个执行栈，同步代码会依次加入到执行栈中依次执行并出栈。
JS引擎线程遇到异步函数，会将异步函数交给相应的Webapi，而继续执行后面的任务。
Webapi会在条件满足的时候，将异步对应的回调加入到消息队列中，等待执行。
执行栈为空时，JS引擎线程会去取消息队列中的回调函数（如果有的话），并加入到执行栈中执行。
完成后出栈，执行栈再次为空，重复上面的操作，这就是事件循环(event loop)机制。